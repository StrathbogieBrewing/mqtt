version: '3'

services:
  caddy:
    image: docker.io/caddy:latest
    restart: unless-stopped
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./Caddyfile:/etc/caddy/Caddyfile:ro
      - ./www:/var/www:ro
      - caddy_data:/data
      - caddy_config:/config

  mosquitto:
    container_name: mosquitto
    image: eclipse-mosquitto:latest # Or a specific version like eclipse-mosquitto:2.0.15
    restart: unless-stopped
    ports:
      - "1883:1883" # Standard MQTT port
      - "9001:9001" # MQTT over WebSockets (if needed)
    volumes:
      - ./mosquitto/config:/mosquitto/config # Mount local config directory
      - mosquitto_data:/mosquitto/data   # Mount local data directory for persistence
      - mosquitto_log:/mosquitto/log     # Mount local log directory
      - caddy_data:/caddy/data

volumes:
  caddy_data:
  caddy_config:

  mosquitto_data:
  mosquitto_log:

networks:
  network:
    driver: bridge


    # nginx:
    #     image: nginx:latest
    #     ports:
    #     - "80:80"
    #     volumes:
    #     - "./nginx.conf:/etc/nginx/nginx.conf"
    #     - "./html:/usr/share/nginx/html"
    #     - ./certbot/www/:/var/www/certbot/:rw  
    #     networks:
    #     - network
    #     restart: always
    # certbot:
    #     image: certbot/certbot:latest
    #     ports:
    #     - "80:80"
    #     volumes:
    #     - ./certbot/www/:/var/www/certbot/:rw
    #     - ./certbot/conf/:/etc/letsencrypt/:rw
    #     networks:
    #     - network